<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FANZZ777</title>
<link rel="stylesheet" href="css/base.css">
<link rel="stylesheet" href="css/header.css">
<link rel="stylesheet" href="css/menu.css">
<link rel="stylesheet" href="css/animation.css">
</head>
<body>
<header class="header gold">
  <div class="logo">FANZZ777</div>
  <div id="authBox"></div>
</header>

<!-- Menu utama -->
<nav class="menu">
  <button onclick="go('slot')"><img src="assets/icons/slot.png" alt="Slot"> Slot</button>
  <button onclick="go('casino')"><img src="assets/icons/casino.png" alt="Casino"> Casino</button>
  <button onclick="go('togel')"><img src="assets/icons/togel.png" alt="Togel"> Togel</button>
  <button onclick="go('arcade')"><img src="assets/icons/arcade.png" alt="Arcade"> Arcade</button>
  <button onclick="go('poker')"><img src="assets/icons/poker.png" alt="Poker"> Poker</button>
  <button onclick="go('developer')"><img src="assets/icons/developer.png" alt="Developer"> Developer</button>
</nav>

<!-- Banner -->
<section class="banner">
  <div class="banner-slider">
    <img src="assets/banners/banner_main.jpg" alt="Banner Main" loading="lazy">
    <img src="assets/banners/banner_pgsoft.jpg" alt="Banner PGSoft" loading="lazy">
    <img src="assets/banners/banner_pragmatic.jpg" alt="Banner Pragmatic" loading="lazy">
    <img src="assets/banners/banner_TopUp.jpg" alt="Banner TopUp" loading="lazy">
    <img src="assets/banners/banner_jualbeli.jpg" alt="Banner JualBeli" loading="lazy">
    <img src="assets/banners/banner_saya.jpg" alt="Banner Saya" loading="lazy">
    <img src="assets/banners/banner_teman.jpg" alt="Banner Teman" loading="lazy">
    <img src="assets/banners/banner_foto1.jpg" alt="Banner Foto1" loading="lazy">
    <img src="assets/banners/banner_foto2.jpg" alt="Banner Foto2" loading="lazy">
    <img src="assets/banners/banner_foto3.jpg" alt="Banner Foto3" loading="lazy">
  </div>
</section>

<!-- Menu Deposit / Withdraw / Histori / Leaderboard / Logout -->
<main id="panel" class="content">
  <h2>Demo Lobby (POINT)</h2>
  <div class="actions">
    <button onclick="openDeposit()"><img src="assets/icons/deposit.png" alt="Deposit"> Deposit</button>
    <button onclick="openWithdraw()"><img src="assets/icons/withdraw.png" alt="Withdraw"> Withdraw</button>
    <button onclick="showHistory()"><img src="assets/icons/history.jpg" alt="Histori"> Histori</button>
    <button onclick="showLeaderboard()"><img src="assets/icons/leaderboard.jpg" alt="Leaderboard"> Leaderboard</button>
    <button onclick="logoutPlayer()"><img src="assets/icons/logout.jpg" alt="Logout"> Logout</button>
  </div>

  <!-- Deposit Modal -->
  <div id="depositModal" class="modal">
    <h3>Deposit</h3>
    <p>Rekening kamu: <span id="playerAccount"></span></p>
    <input type="number" id="depositAmount" placeholder="Ketik nominal deposit">
    <p>Rekening Tujuan QRIS:</p>
    <img src="assets/qris/qris_main.jpg" alt="QRIS" style="width:150px;">
    <br><br>
    <button onclick="confirmDeposit()">Konfirmasi</button>
    <button onclick="closeDeposit()">Batal</button>
  </div>

  <!-- Withdraw Modal -->
  <div id="withdrawModal" class="modal">
    <h3>Withdraw</h3>
    <p>Rekening tujuan: <span id="playerAccountWithdraw"></span></p>
    <input type="number" id="withdrawAmount" placeholder="Ketik nominal withdraw">
    <br><br>
    <button onclick="confirmWithdraw()">Konfirmasi</button>
    <button onclick="closeWithdraw()">Batal</button>
  </div>

  <!-- Histori -->
  <div id="historyPanel" class="panel">
    <h3>Histori</h3>
    <ul id="historyList"></ul>
  </div>

  <!-- Leaderboard -->
  <div id="leaderboardPanel" class="panel">
    <h3>Leaderboard</h3>
    <ul id="leaderboardList"></ul>
  </div>
</main>

<script src="js/data-games.js"></script>
<script src="js/render-games.js"></script>
<script src="js/history.js"></script>
<script src="js/navigation.js"></script>
<script src="js/interaction.js"></script>
<script src="js/wallet.js"></script>

<script>
// ----- MODAL OPEN/CLOSE -----
function openDeposit() {
  const current = JSON.parse(localStorage.getItem('currentPlayer')) || {};
  document.getElementById('playerAccount').innerText = current.ewallet || current.bank || '-';
  document.getElementById('depositModal').style.display = 'block';
}

function closeDeposit(){ document.getElementById('depositModal').style.display='none'; }

function openWithdraw() {
  const current = JSON.parse(localStorage.getItem('currentPlayer')) || {};
  document.getElementById('playerAccountWithdraw').innerText = current.ewallet || current.bank || '-';
  document.getElementById('withdrawModal').style.display='block';
}

function closeWithdraw(){ document.getElementById('withdrawModal').style.display='none'; }

// ----- DEPOSIT -----
function confirmDeposit(){
  const amount = parseInt(document.getElementById('depositAmount').value);
  if(!amount){ alert("Masukkan nominal deposit!"); return; }

  const player = JSON.parse(localStorage.getItem('currentPlayer')) || {};
  player.saldo = (player.saldo||0)+amount;
  saveCurrentPlayer(player);

  const history = JSON.parse(localStorage.getItem('history')) || [];
  history.push({type:'Deposit', amount, date:new Date().toLocaleString(), user:player.username});
  localStorage.setItem('history', JSON.stringify(history));

  alert("Deposit berhasil!");
  closeDeposit();
  showLeaderboard();
}

// ----- WITHDRAW -----
function confirmWithdraw(){
  const amount = parseInt(document.getElementById('withdrawAmount').value);
  const player = JSON.parse(localStorage.getItem('currentPlayer')) || {};
  if(!amount){ alert("Masukkan nominal withdraw!"); return; }
  if(amount > (player.saldo||0)){ alert("Saldo tidak cukup!"); return; }

  player.saldo -= amount;
  saveCurrentPlayer(player);

  const history = JSON.parse(localStorage.getItem('history')) || [];
  history.push({type:'Withdraw', amount, date:new Date().toLocaleString(), user:player.username});
  localStorage.setItem('history', JSON.stringify(history));

  alert("Withdraw berhasil!");
  closeWithdraw();
  showLeaderboard();
}

// ----- HISTORI -----
function showHistory(){
  document.getElementById('historyPanel').style.display='block';
  document.getElementById('leaderboardPanel').style.display='none';
  const history = JSON.parse(localStorage.getItem('history')) || [];
  const player = JSON.parse(localStorage.getItem('currentPlayer')) || {};
  const list = document.getElementById('historyList');
  list.innerHTML='';
  history.filter(h=>h.user===player.username)
         .forEach(h=>{
           const li = document.createElement('li');
           li.textContent = `${h.date} - ${h.type}: ${h.amount}`;
           list.appendChild(li);
         });
}

// ----- LEADERBOARD -----
function showLeaderboard(){
  document.getElementById('leaderboardPanel').style.display='block';
  document.getElementById('historyPanel').style.display='none';
  const history = JSON.parse(localStorage.getItem('history')) || [];
  const leaderboard = {};
  history.forEach(h=>{ if(!leaderboard[h.user]) leaderboard[h.user]=0; leaderboard[h.user]+=h.amount; });
  const sorted = Object.entries(leaderboard).sort((a,b)=>b[1]-a[1]);
  const list = document.getElementById('leaderboardList'); list.innerHTML='';
  sorted.forEach(([user,total])=>{
    const li=document.createElement('li'); li.textContent=`${user}: ${total}`; list.appendChild(li);
  });
}
</script>
</body>
      </html>

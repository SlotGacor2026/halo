<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FANZZ777 - Kontrol Bandar</title>
<link rel="stylesheet" href="css/base.css">
<link rel="stylesheet" href="css/header.css">
<link rel="stylesheet" href="css/menu.css">
<link rel="stylesheet" href="css/animation.css">
<style>
table { width:100%; border-collapse: collapse; margin-top:10px; }
table, th, td { border:1px solid gold; }
th, td { padding:8px; text-align:center; color:gold; }
.pending-btn { background:#222; color:gold; border:none; padding:5px 10px; cursor:pointer; border-radius:6px; }
.pending-btn:hover { background:gold; color:#222; }
</style>
</head>
<body>
<header class="header gold">
  <div class="logo">FANZZ777 - Bandar</div>
</header>

<main class="content">
  <h2>Daftar Pemain</h2>
  <table id="playersTable">
    <thead>
      <tr>
        <th>Username</th>
        <th>Rekening / Ewallet</th>
        <th>Saldo</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Pending Deposit / Withdraw</h2>
  <table id="pendingTable">
    <thead>
      <tr>
        <th>User</th>
        <th>Type</th>
        <th>Nominal</th>
        <th>Tanggal</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</main>

<script>
// ----- Render daftar pemain -----
function renderPlayers(){
  const players = JSON.parse(localStorage.getItem('players')) || [];
  const tbody = document.querySelector('#playersTable tbody');
  tbody.innerHTML='';
  players.forEach(p=>{
    const tr = document.createElement('tr');
    tr.innerHTML=`<td>${p.username}</td><td>${p.ewallet || p.bank || '-'}</td><td>${p.saldo||0}</td>`;
    tbody.appendChild(tr);
  });
}

// ----- Render pending deposit/withdraw -----
function renderPending(){
  const pending = JSON.parse(localStorage.getItem('pending')) || [];
  const tbody = document.querySelector('#pendingTable tbody');
  tbody.innerHTML='';
  pending.forEach((p,index)=>{
    const tr = document.createElement('tr');
    tr.innerHTML=`
      <td>${p.user}</td>
      <td>${p.type}</td>
      <td>${p.amount}</td>
      <td>${p.date}</td>
      <td>
        <button class="pending-btn" onclick="accPending(${index})">ACC</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// ----- ACC pending -----
function accPending(index){
  const pending = JSON.parse(localStorage.getItem('pending')) || [];
  const p = pending[index];
  const players = JSON.parse(localStorage.getItem('players')) || [];
  const player = players.find(u=>u.username===p.user);
  if(!player){ alert("Player tidak ditemukan!"); return; }

  if(p.type==='Deposit'){ player.saldo = (player.saldo||0)+p.amount; }
  if(p.type==='Withdraw'){ player.saldo = (player.saldo||0)-p.amount; }

  localStorage.setItem('players', JSON.stringify(players));

  // masukkan ke history pemain
  const history = JSON.parse(localStorage.getItem('history')) || [];
  history.push({type:p.type, amount:p.amount, user:p.user, date:p.date});
  localStorage.setItem('history', JSON.stringify(history));

  pending.splice(index,1);
  localStorage.setItem('pending', JSON.stringify(pending));

  renderPlayers();
  renderPending();
}

renderPlayers();
renderPending();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FANZZ777 - Bandar Control</title>
<link rel="stylesheet" href="css/base.css">
<link rel="stylesheet" href="css/menu.css">
</head>
<body>
<header>
  <h1>Kontrol Bandar</h1>
</header>

<main>
  <h2>Request Deposit & Withdraw Pemain</h2>
  <div id="requestList"></div>
</main>

<script>
/* Bandar login statik (kamu saja) */
const bandarUsername = "admin";
const bandarPassword = "admin123";

/* Cek login */
let loggedIn = false;
while(!loggedIn){
  let u = prompt("Username Bandar:");
  let p = prompt("Password Bandar:");
  if(u===bandarUsername && p===bandarPassword){
    loggedIn = true;
    alert("Selamat datang, Bandar!");
  } else {
    alert("Username / Password salah");
  }
}

/* Render request pemain */
function renderRequests(){
  const list = document.getElementById("requestList");
  list.innerHTML="";
  let requests = JSON.parse(localStorage.getItem("pendingRequests")||"[]");
  if(requests.length===0){
    list.innerHTML="<p>Tidak ada request</p>";
    return;
  }
  requests.forEach((r,i)=>{
    let div = document.createElement("div");
    div.innerHTML=`
      <p>${r.type.toUpperCase()} | Pemain: ${r.username} | Nomor: ${r.no} | Coin: ${r.coin}</p>
      <button onclick="approve(${i})">ACC</button>
      <button onclick="decline(${i})">Tolak</button>
    `;
    list.appendChild(div);
  });
}

function approve(i){
  let requests = JSON.parse(localStorage.getItem("pendingRequests")||"[]");
  let req = requests[i];
  let users = JSON.parse(localStorage.getItem("users")||"{}");
  if(!users[req.username]) return alert("User tidak ditemukan");
  if(req.type==="deposit") users[req.username].coin += req.coin;
  if(req.type==="withdraw") {
    if(users[req.username].coin>=req.coin){
      users[req.username].coin -= req.coin;
    } else return alert("Coin tidak cukup");
  }
  localStorage.setItem("users", JSON.stringify(users));
  requests.splice(i,1);
  localStorage.setItem("pendingRequests", JSON.stringify(requests));
  renderRequests();
}

function decline(i){
  let requests = JSON.parse(localStorage.getItem("pendingRequests")||"[]");
  requests.splice(i,1);
  localStorage.setItem("pendingRequests", JSON.stringify(requests));
  renderRequests();
}

renderRequests();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kontrol Bandar - FANZZ777</title>
<link rel="stylesheet" href="css/base.css">
<link rel="stylesheet" href="css/menu.css">
</head>
<body>

<header class="header gold">
  <div class="logo">FANZZ777 - Bandar</div>
</header>

<main class="content">
  <h2>Kontrol Bandar</h2>

  <!-- Daftar pemain -->
  <section>
    <h3>Daftar Pemain</h3>
    <table border="1" cellpadding="5" cellspacing="0" style="width:100%; color:gold; background:#111;">
      <thead>
        <tr>
          <th>Username</th>
          <th>Saldo</th>
          <th>Rekening/E-Wallet</th>
        </tr>
      </thead>
      <tbody id="playerList"></tbody>
    </table>
  </section>

  <!-- Histori semua pemain -->
  <section>
    <h3>Histori Transaksi</h3>
    <ul id="allHistory"></ul>
  </section>

  <!-- Leaderboard -->
  <section>
    <h3>Leaderboard</h3>
    <ul id="bandarLeaderboard"></ul>
  </section>
</main>

<script>
// ----- LOAD DATA BANDAR -----
function loadBandarData() {
  const players = JSON.parse(localStorage.getItem('players')) || [];
  const tbody = document.getElementById('playerList');
  tbody.innerHTML = '';
  players.forEach(p => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${p.username}</td><td>${p.saldo || 0}</td><td>${p.ewallet || p.bank || '-'}</td>`;
    tbody.appendChild(tr);
  });

  // Histori semua pemain
  const history = JSON.parse(localStorage.getItem('history')) || [];
  const histList = document.getElementById('allHistory');
  histList.innerHTML = '';
  history.forEach(h => {
    const li = document.createElement('li');
    li.textContent = `${h.date} - ${h.user} - ${h.type}: ${h.amount}`;
    histList.appendChild(li);
  });

  // Leaderboard
  const leaderboard = {};
  history.forEach(h => {
    if(!leaderboard[h.user]) leaderboard[h.user]=0;
    leaderboard[h.user]+=h.amount;
  });
  const sorted = Object.entries(leaderboard).sort((a,b)=>b[1]-a[1]);
  const lb = document.getElementById('bandarLeaderboard'); lb.innerHTML='';
  sorted.forEach(([user,total])=>{
    const li = document.createElement('li');
    li.textContent = `${user}: ${total}`;
    lb.appendChild(li);
  });
}

window.onload = loadBandarData;
</script>

</body>
</html>

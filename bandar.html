<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Bandar</title>

<style>
body{
  background:#000;
  color:gold;
  font-family:Arial, sans-serif;
  margin:0;
  padding:15px;
}
h2{text-align:center}

.box{
  background:#111;
  border:1px solid gold;
  border-radius:10px;
  padding:10px;
  margin-bottom:15px;
}

button{
  padding:6px 12px;
  margin:4px;
  border:none;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
}
.acc{background:lime;color:#000}
.tolak{background:red;color:#fff}
.refresh{background:gold;color:#000}
</style>
</head>

<body>

<h2>ðŸ“Š PANEL BANDAR (TANPA LOGIN)</h2>
<button class="refresh" onclick="loadPlayers()">ðŸ”„ Refresh Data</button>
<br><br>

<div id="playerList"></div>

<script>
function loadPlayers(){
  let data = JSON.parse(localStorage.players || "[]");
  playerList.innerHTML = "";

  if(data.length === 0){
    playerList.innerHTML = "<p>Tidak ada pemain</p>";
    return;
  }

  data.forEach(p=>{
    let box = document.createElement("div");
    box.className = "box";

    let rekening = p.wallet
      ? `${p.wallet} - ${p.walletNum}`
      : `${p.bank} - ${p.bankNum}`;

    let transaksi = "";
    p.history.forEach((h,i)=>{
      if(typeof h === "string"){
        transaksi += `<li>${h}</li>`;
      }else{
        transaksi += `
          <li>
            ${h.type.toUpperCase()} ${h.amount} (${h.status})
            ${h.status==="pending" ? `
              <br>
              <button class="acc" onclick="acc('${p.username}',${i})">ACC</button>
              <button class="tolak" onclick="tolak('${p.username}',${i})">TOLAK</button>
            ` : ""}
          </li>
        `;
      }
    });

    box.innerHTML = `
      <b>Username:</b> ${p.username}<br>
      <b>Nama Rekening:</b> ${p.name}<br>
      <b>Rekening:</b> ${rekening}<br>
      <b>Saldo:</b> ${p.saldo}<br><br>
      <b>Histori Transaksi:</b>
      <ul>${transaksi}</ul>
    `;
    playerList.appendChild(box);
  });
}

function acc(username,index){
  let data = JSON.parse(localStorage.players);
  let p = data.find(x=>x.username===username);
  let h = p.history[index];

  if(typeof h === "string"){
    alert("Histori lama tidak bisa di-ACC");
    return;
  }

  if(h.type==="deposit") p.saldo += h.amount;
  if(h.type==="withdraw") p.saldo -= h.amount;

  h.status = "acc";
  save(data);
}

function tolak(username,index){
  let data = JSON.parse(localStorage.players);
  let p = data.find(x=>x.username===username);
  p.history[index].status = "tolak";
  save(data);
}

function save(data){
  localStorage.players = JSON.stringify(data);
  loadPlayers();
}

window.onload = loadPlayers;
</script>

</body>
</html>

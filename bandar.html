<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Bandar</title>

<style>
body{
  background:#000;
  color:#fff;
  font-family:Arial, sans-serif;
  padding:15px;
}
h2{text-align:center;color:gold}

.table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #444;
  padding:8px;
  text-align:center;
}
th{background:#111;color:gold}
tr:nth-child(even){background:#0d0d0d}

button{
  padding:5px 10px;
  border:none;
  border-radius:5px;
  font-weight:bold;
  cursor:pointer;
  margin:2px;
}
.acc{background:lime;color:#000}
.tolak{background:red;color:#fff}
.refresh{background:gold;color:#000;margin-bottom:10px}

.empty{
  text-align:center;
  margin-top:20px;
  color:#aaa;
}
</style>
</head>

<body>

<h2>ðŸ“Š PANEL BANDAR</h2>
<button class="refresh" onclick="loadData()">ðŸ”„ Refresh</button>

<table class="table">
<thead>
<tr>
  <th>Username</th>
  <th>Jenis</th>
  <th>Nama Rekening</th>
  <th>Nomor Rekening</th>
  <th>Nominal</th>
  <th>Status</th>
</tr>
</thead>
<tbody id="dataRow"></tbody>
</table>

<div id="kosong" class="empty"></div>

<script>
function loadData(){
  let players = JSON.parse(localStorage.players || "[]");
  let tbody = document.getElementById("dataRow");
  let kosong = document.getElementById("kosong");

  tbody.innerHTML = "";
  kosong.innerHTML = "";
  let ada = false;

  players.forEach(p=>{
    (p.history||[]).forEach((h,i)=>{
      if(h.status==="pending"){
        ada = true;
        let rek = p.wallet ? p.wallet+" "+p.walletNum : p.bank+" "+p.bankNum;

        let tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${p.username}</td>
          <td>${h.type.toUpperCase()}</td>
          <td>${p.name}</td>
          <td>${rek}</td>
          <td>Rp ${h.amount.toLocaleString()}</td>
          <td>
            <button class="acc" onclick="acc('${p.username}',${i})">ACC</button>
            <button class="tolak" onclick="tolak('${p.username}',${i})">TOLAK</button>
          </td>
        `;
        tbody.appendChild(tr);
      }
    });
  });

  if(!ada){
    kosong.innerHTML = "Tidak ada permintaan Deposit / Withdraw";
  }
}

function acc(username,index){
  let players = JSON.parse(localStorage.players);
  let p = players.find(x=>x.username===username);
  let h = p.history[index];

  if(h.type==="deposit") p.saldo += h.amount;
  if(h.type==="withdraw") p.saldo -= h.amount;

  h.status = "acc";
  save(players);
}

function tolak(username,index){
  let players = JSON.parse(localStorage.players);
  let p = players.find(x=>x.username===username);
  p.history[index].status = "tolak";
  save(players);
}

function save(data){
  localStorage.players = JSON.stringify(data);
  loadData();
}

window.onload = loadData;
</script>

</body>
</html>

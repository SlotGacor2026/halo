<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahjong Ways</title>
<link rel="stylesheet" href="../css/base.css">
<link rel="stylesheet" href="../css/games.css">
<link rel="stylesheet" href="../css/animation.css">
<style>
#loader{position:fixed;inset:0;background:#121a2a;display:grid;place-items:center;color:gold;font-size:36px;z-index:9999;flex-direction:column}
#game-container{display:none;text-align:center;padding:20px;}
#reels{display:flex;justify-content:center;margin:20px 0;gap:10px;}
.reel{width:80px;height:80px;border:2px solid gold;border-radius:10px;overflow:hidden;background:#2b1e0f;display:grid;place-items:center;transition:transform 0.5s;}
.reel img{width:100%;height:100%;}
button{padding:10px 20px;margin:5px;font-size:16px;border-radius:8px;}
.scatter{animation:scatter-glow 1s infinite alternate;}
@keyframes scatter-glow{0%{transform:translateY(0) scale(1);box-shadow:0 0 10px gold}50%{transform:translateY(-10px) scale(1.1);box-shadow:0 0 25px gold}100%{transform:translateY(0) scale(1);box-shadow:0 0 10px gold}}
.big-win{position:fixed;inset:0;background:rgba(0,0,0,.7);display:grid;place-items:center;font-size:48px;color:gold;z-index:9999;animation:pop 1s;}
@keyframes pop{0%{transform:scale(.5);opacity:0}100%{transform:scale(1);opacity:1}}
</style>
</head>
<body>

<div id="loader">
  <img src="../assets/thumbnails/mahjong_logo.png" alt="Mahjong Ways" width="200">
  <p>Loading...</p>
</div>

<div id="game-container">
  <h2>Mahjong Ways</h2>
  <p>Balance: <span id="balance">1000</span> | Bet: <span id="bet">10</span></p>
  
  <div>
    <button id="btn-decrease">-</button>
    <button id="btn-increase">+</button>
    <button id="btn-autoplay">Autoplay</button>
  </div>
  
  <div id="reels">
    <div class="reel"><img src="../assets/thumbnails/mahjong_1.png"></div>
    <div class="reel"><img src="../assets/thumbnails/mahjong_2.png"></div>
    <div class="reel"><img src="../assets/thumbnails/mahjong_3.png"></div>
    <div class="reel"><img src="../assets/thumbnails/mahjong_4.png"></div>
    <div class="reel"><img src="../assets/thumbnails/mahjong_5.png"></div>
  </div>
  
  <button id="btn-spin">Spin</button>
  <p id="msg"></p>
</div>

<script src="../js/interaction.js"></script>
<script>
const loader = document.getElementById('loader');
const game = document.getElementById('game-container');
const btnSpin = document.getElementById('btn-spin');
const btnAuto = document.getElementById('btn-autoplay');
const reels = document.querySelectorAll('.reel img');
const btnInc = document.getElementById('btn-increase');
const btnDec = document.getElementById('btn-decrease');
const balanceEl = document.getElementById('balance');
const betEl = document.getElementById('bet');
const msg = document.getElementById('msg');

let balance = 1000;
let bet = 10;
let autoplay = false;
let autoplayInterval;

// Loading simulation
window.addEventListener('load', ()=>{
  setTimeout(()=>{
    loader.style.display='none';
    game.style.display='block';
  }, 3000);
});

// Bet buttons
btnInc.addEventListener('click', ()=>{ bet+=10; betEl.textContent=bet; });
btnDec.addEventListener('click', ()=>{ if(bet>10){bet-=10;betEl.textContent=bet;} });

// Spin function
function spin(){
  if(bet>balance){ msg.textContent="Balance tidak cukup!"; return; }
  balance -= bet; balanceEl.textContent = balance;
  msg.textContent="";
  
  let symbols = [
    "../assets/thumbnails/mahjong_1.png",
    "../assets/thumbnails/mahjong_2.png",
    "../assets/thumbnails/mahjong_3.png",
    "../assets/thumbnails/mahjong_4.png",
    "../assets/thumbnails/mahjong_5.png"
  ];
  
  reels.forEach((r,i)=>{
    let count = 0;
    let spinInterval = setInterval(()=>{
      r.src = symbols[Math.floor(Math.random()*symbols.length)];
      count++;
      if(count>10+i*2){ clearInterval(spinInterval); checkWin(); }
    }, 100);
  });
}

// Check win + scatter animation
function checkWin(){
  reels.forEach(r=>{
    if(Math.random()<0.2){ r.parentElement.classList.add('scatter'); setTimeout(()=>r.parentElement.classList.remove('scatter'),1000);}
  });
  let win = Math.random()<0.3;
  if(win){
    let winAmount = bet*5;
    balance += winAmount; balanceEl.textContent=balance;
    msg.textContent = "BIG WIN! +" + winAmount;
    msg.classList.add('big-win');
    setTimeout(()=>msg.classList.remove('big-win'),1500);
  }
}

// Event listeners
btnSpin.addEventListener('click', spin);
btnAuto.addEventListener('click', ()=>{
  autoplay = !autoplay;
  if(autoplay){ autoplayInterval=setInterval(spin,2000); btnAuto.textContent="Stop Autoplay"; }
  else { clearInterval(autoplayInterval); btnAuto.textContent="Autoplay"; }
});
</script>

</body>
                        </html>
